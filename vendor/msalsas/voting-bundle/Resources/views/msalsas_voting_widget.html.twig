{# This file is part of the MsalsasVotingBundle package.

(c) Manolo Salsas

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code. #}

{% macro shakeIt(id,isComment) %}
    {% if isComment %}
        {% set votes = msalsas_voting_voter.positiveVotesComment(id) %}
        {% set userVote = msalsas_voting_voter.userVoteComment(id) %}
        {% set clicks = msalsas_voting_clicker.clicks(id) %}
        {% set published = msalsas_voting_voter.publishedComment(id) %}

    {% else %}
        {% set votes = msalsas_voting_voter.positiveVotes(id) %}
        {% set userVote = msalsas_voting_voter.userVote(id) %}
        {% set clicks = msalsas_voting_clicker.clicks(id) %}
        {% set published = msalsas_voting_voter.published(id) %}
    {% endif %}

{#    <div class="msalsas-voting-widget-wrapper">
        <div class="msalsas-voting-widget">
            <div class="msalsas-voting-shakes{% if published %} published{% endif %}">
                <p id="msalsas-voting-shakes-{{ id }}">{{ votes|default(0) }}</p> <i class="fa fa-heart {% if userVote %} --liked {% endif %}"></i>


            </div>
            <div class="msalsas-voting-shake-it{% if userVote %} --liked {% endif %}"
                 id="msalsas-voting-a-shake-{{ id }}"
                 data-id="{{ id }}"
                 data-shakentext="{{ 'msalsas_voting.shaken'|trans }}"
                    {% if isComment %}
                 data-comment="true"
                 data-url="{{ path('positive_vote_comment', {id: id, _locale: app.request.locale}) }}">
                {% else %}
                    data-url="{{ path('positive_vote', {id: id, _locale: app.request.locale}) }}">
                {% endif %}



                {% if not userVote %}
                    <a  href="javascript:void(0)">{{ 'msalsas_voting.shake_it'|trans }}</a>
                {% elseif userVote.positive %}
                    <span class="liked" id="msalsas-voting-a-positive-{{ id }}">{{ 'msalsas_voting.shaken'|trans }}</span>


                {% else %}
                    <span class="dislked" id="msalsas-voting-a-negative-{{ id }}">{{ userVote.reason|trans }}</span>
                {% endif %}
            </div>

            #}{#  <div class="msalsas-voting-clicks{% if published %} published{% endif %}">
                  {% if clicks %}
                      {{ 'msalsas_voting.clicks'|transchoice(clicks) }}
                  {% else %}
                      &nbsp;
                  {% endif %}
              </div>#}{#
        </div>
    </div>#}

    <div class="msalsas-voting-widget-wrapper">
        <div class="msalsas-voting-widget">
            <div class="msalsas-voting-shakes{% if published %} published{% endif %}">
                <p id="msalsas-voting-shakes-{{ id }}"></p>
            </div>
            <div class="msalsas-voting-shake-it{% if userVote %} --liked {% endif %}"
                 id="msalsas-voting-a-shake-{{ id }}"
                 data-id="{{ id }}"
                 data-shakentext="{{ 'msalsas_voting.shaken'|trans }}"
                    {% if isComment %}
                        data-comment="true"
                        data-url="{{ path('positive_vote_comment', {id: id, _locale: app.request.locale}) }}">
                    {% else %}
                        data-url="{{ path('positive_vote', {id: id, _locale: app.request.locale}) }}">
                    {% endif %}



                {% if not userVote %}
                    <div  class="like">

                        <svg width="397" height="470" version="1" id="svg-heart-{{ id }}" >
                            <path class="main" d="M211 226c9-9 21-14 34-14 29 0 50 26 50 54 0 34-53 77-78 95-5 3-7 3-12 0-25-18-78-61-78-95 0-28 21-54 50-54 13 0 25 5 34 14z"/>

                            <path class="second" d="M211 226c9-9 21-14 34-14 29 0 50 26 50 54 0 34-53 77-78 95-5 3-7 3-12 0-25-18-78-61-78-95 0-28 21-54 50-54 13 0 25 5 34 14z"/>

                            <path class="line line1" d="M171 294c-43-12-106-47-111-62-18-52 0-125 0-125"/>
                            <path class="line line2" d="M197 244c-11-31-25-75-32-119-12-79-5-125-5-125"/>
                            <path class="line line3" d="M258 251c23-18 49-43 61-67 25-50 19-74 13-153"/>
                            <path class="line line4" d="M246 304c22 15 54 34 79 37 46 7 58-53 62-88s-8-96-8-96"/>
                            <path class="line line5" d="M217 330c6 36 23 85 62 111 69 46 117-56 117-56"/>
                            <path class="line line6" d="M204 330c-9 46-25 112-46 134-34 35-66-111-66-111"/>
                            <path class="line line7" d="M191 309c-24 25-69 63-108 74C15 402 0 234 0 234"/>
                        </svg>
                        <img class="heart heart1" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart2" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart3" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart4" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart5" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart6" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart7" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <div class="like__number" id="like__number-{{ id }}">{{ votes|default(0) }}</div>
                    </div>
                {% elseif userVote.positive %}
                    <div  id="msalsas-voting-a-positive-{{ id }}"  class="like active">

                        <svg width="397" height="470" version="1">
                            <path class="main" d="M211 226c9-9 21-14 34-14 29 0 50 26 50 54 0 34-53 77-78 95-5 3-7 3-12 0-25-18-78-61-78-95 0-28 21-54 50-54 13 0 25 5 34 14z" style="transform: scale(0);"></path>
                            <path class="second" d="M211 226c9-9 21-14 34-14 29 0 50 26 50 54 0 34-53 77-78 95-5 3-7 3-12 0-25-18-78-61-78-95 0-28 21-54 50-54 13 0 25 5 34 14z" style="transform: scale(1);"></path>

                            <path class="line line1" d="M171 294c-43-12-106-47-111-62-18-52 0-125 0-125"/>
                            <path class="line line2" d="M197 244c-11-31-25-75-32-119-12-79-5-125-5-125"/>
                            <path class="line line3" d="M258 251c23-18 49-43 61-67 25-50 19-74 13-153"/>
                            <path class="line line4" d="M246 304c22 15 54 34 79 37 46 7 58-53 62-88s-8-96-8-96"/>
                            <path class="line line5" d="M217 330c6 36 23 85 62 111 69 46 117-56 117-56"/>
                            <path class="line line6" d="M204 330c-9 46-25 112-46 134-34 35-66-111-66-111"/>
                            <path class="line line7" d="M191 309c-24 25-69 63-108 74C15 402 0 234 0 234"/>
                        </svg>
                        <img class="heart heart1" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart2" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart3" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart4" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart5" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart6" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <img class="heart heart7" src="https://alikinvv.github.io/like-animation/build/img/dating-hearts.svg" width="40" alt="">
                        <div class="like__number" id="like__number-{{ id }}">{{ votes|default(0) }}</div>
                    </div>


                {% else %}
                    <span class="dislked" id="msalsas-voting-a-negative-{{ id }}">{{ userVote.reason|trans }}</span>
                {% endif %}
            </div>

          {#  <div class="msalsas-voting-clicks{% if published %} published{% endif %}">
                {% if clicks %}
                    {{ 'msalsas_voting.clicks'|transchoice(clicks) }}
                {% else %}
                    &nbsp;
                {% endif %}
            </div>#}
        </div>
    </div>


{% endmacro shakeIt %}

{% macro bottomBar(id) %}
    {% set votes = msalsas_voting_voter.positiveVotes(id) %}
    {% set anonymousVotes = msalsas_voting_voter.anonymousVotes(id) %}
    {% set userPositiveVotes = msalsas_voting_voter.userPositiveVotes(id) %}
    {% set negativeVotes = msalsas_voting_voter.negativeVotes(id) %}
    {% set userVote = msalsas_voting_voter.userVote(id) %}
    {% set negativeReasons = msalsas_voting_voter.negativeReasons() %}
    <div class="msalsas-voting-bottom-bar-wrapper">
        <div class="msalsas-voting-bottom-bar">
            <span class="msalsas-voting-bottom-bar-votes-up" data-toggle="tooltip" data-placement="top" title="{{ 'msalsas_voting.positive_votes'|trans }}"><i class="fa fa-arrow-circle-up"></i> <strong><span id="msalsas-voting-bottom-bar-votes-up-{{ id }}" >{{ userPositiveVotes|default(0) }}</span></strong></span>
            <span class="msalsas-voting-bottom-bar-votes-anonymous" data-toggle="tooltip" data-placement="top" title="{{ 'msalsas_voting.anonymous_votes'|trans }}"><i class="fa fa-user-secret"></i> <strong><span id="msalsas-voting-bottom-bar-votes-anonymous-{{ id }}" >{{ anonymousVotes|default(0) }}</span></strong></span>
            <span class="msalsas-voting-bottom-bar-votes-down" data-toggle="tooltip" data-placement="top" title="{{ 'msalsas_voting.negative_votes'|trans }}"><i class="fa fa-arrow-circle-down"></i> <strong><span id="msalsas-voting-bottom-bar-votes-down-{{ id }}">{{ negativeVotes|default(0) }}</span></strong></span>

            {% if not userVote and msalsas_voting_voter.userCanVoteNegative(id) %}
                <form action=""
                      id="msalsas-voting-problem-{{ id }}"
                      data-url="{{ path('negative_vote', {id: id, _locale: app.request.locale}) }}"
                      data-id="{{ id }}"
                >
                    <select name="ratings">
                        <option value="0" selected="selected">{{ 'msalsas_voting.problem'|trans }}</option>
                        {% for value in negativeReasons %}
                            <option value="{{ value }}">{{ value|trans }}</option>
                        {% endfor %}
                    </select>
                </form>
            {% endif %}
        </div>
    </div>
{% endmacro bottomBar %}

{% macro shakeItModal() %}
    <div id="msalsas-modal">
        <div class="msalsas-modal-content">
            <span class="msalsas-close">&times;</span>
            <p id="msalsas-modal-text">Error</p>
        </div>
    </div>
{% endmacro %}

{% macro shakeItCSS() %}
    <style>{{ source('@msalsas_voting.public/css/msalsas_voting_styles.css') }}</style>
{% endmacro shakeItCSS %}

{% macro shakeItJS() %}
    <script>{{ source('@msalsas_voting.public/js/msalsas_voting_shakeIt.js') }}</script>
    <script>{{ source('@msalsas_voting.public/js/msalsas_voting_bottomBar.js') }}</script>
{% endmacro shakeItJS %}
