{% extends 'base.html.twig' %}

{% block title %}
    Voir un bien!
{% endblock %}

{% block style_custom %}

    <style>

    </style>
{% endblock %}
{% block body %}
    {% import "@msalsas_voting/msalsas_voting_widget.html.twig" as msalsas_voting_widget %}
    {{ msalsas_voting_widget.shakeItCSS() }}
    {{ msalsas_voting_widget.shakeItJS() }}
    {{ msalsas_voting_widget.shakeItModal() }}
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">
            {{ message }}
        </div>
    {% endfor %}

    <div class="row">
        <div class="col-md-10">
            <div class="slider">

                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div style="    border-radius: 0.25rem;" class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100 lazyload " src="{{ asset("img/lowres.png") }}" data-src={{ article.image }} alt="AlternateText" height="290px"/>
                        </div>
                        {#<div class="carousel-item">#}
                            {#<img class="d-block w-100 lazyload " src="{{ asset("img/lowres.png") }}" data-src={{ article.image }} alt="AlternateText" height="290px"/>#}
                        {#</div>#}
                        {#<div class="carousel-item">#}
                            {#<img class="d-block w-100 lazyload " src="{{ asset("img/lowres.png") }}" data-src={{ article.image }} alt="AlternateText" height="290px"/>#}

                        {#</div>#}
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>

            <div class="div-cadre-orange">
                <div class="cadre">
                    <div class="cadre margin-top--22">
                        <h1>{{ article.title }}</h1>
                        <h4 class="pb-3" style="float: right;padding: 10px;
 font-size: 1em;">Temps de lecture : <strong>10min</strong></h4>
                        {{ msalsas_voting_widget.shakeIt(article.id) }}

                        <p>{{ article.text | raw }}</p>

                    </div>
                    {{ msalsas_voting_widget.bottomBar( article.id) }}
                </div>
            </div>
        </div>




        <div class="col-md-2">
            <div class="div-cadre-orange">
                <div class="cadre">
                    <h4 class="pb-3">Cat√©gorie</h4>
                    <ul class="ul-caracteristiques ">

                        <li style="width: 100%">
                            <div class="badge badge-primary d-inline-flex align-items-center d-flex justify-content-around"
                                 style="padding: 10px;min-width: 100%;">
                                <i class="fas fa-thermometer-half mr-md-3 mr-sm-1" style="font-size: 2.5em"></i>
                                <span class="vertical-align-mid"> {{ article.categorie.name }} </span>
                            </div>

                        </li>
                        <li style="width: 100%">{% if  article.author.username is defined %}
                                {{ article.author.username }}
                            {% endif %}</li>
                        <li>{{ article.createdAt | date('d/m/Y H:i', timezone='Europe/Paris') }}</li>
                    </ul>

                </div>
            </div>
        </div>
    </div>



    <section class="comments">
        {% for comment in comments  %}


            <article class="comment">
                <a class="comment-img" href="#non">
                    <img src="https://api.adorable.io/avatars/50/{{ comment.user.username }}@adorable.io.png" alt="" width="50" height="50">
                </a>
                <div class="comment-body">
                    {% set isComment = true %}
                    {{ msalsas_voting_widget.shakeIt(comment.id,isComment ) }}
                    {% if comment.user == app.user %}
                        <ul class="comment-actions">
                            <li class="edit"><a id="{{ comment.id }}" href="#" onclick="edit(event)" class="btn btn-primary btn-sm"><i class="fa fa-cog"></i></a></li>
                            <li class="delete"><a  href="{{ path('delete.comment',{'comment' : comment.id}) }}" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i></a></li>
                        </ul>
                    {% endif %}
                    <div class="text">
                        <p>{{ comment.textComment}}</p>
                    </div>
                    <p class="attribution">de <a href="#non">{{ comment.user.username }}</a>, {{ comment.createdAt| ago }}</p>
                </div>

            </article>
        {% endfor %}
    </section>


    {% if app.user %}
        {{ form_start(formComment) }}
        {{ form_row(formComment.textComment) }}
        {{ form_row(formComment.submit) }}
        {{ form_end(formComment) }}
    {% endif %}





{% endblock %}


  {% block javascripts %}
      <script>
          function edit(e){

              e.preventDefault();
              var btn = e.currentTarget;

              //console.log(btn.attributes[0].value);

              btn.offsetParent.nextSibling.nextSibling.innerHTML = "<form action='/comment/edit/"+ btn.attributes[0].value +"' method='post'><input class='edit_input' type='text' value='" + e.target.offsetParent.nextSibling.nextSibling.innerText + "' /></form>";

              btn.style.display="none";
          }
      </script>
  {% endblock %}
